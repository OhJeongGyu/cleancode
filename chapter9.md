### 2017. 2. 27
# 단위 테스트
---
### TDD 법칙 세 가지
> 실제 코드를 짜기 전에 단위 테스트부터 작성하라.

**세 가지 법칙**
1. 실패하는 단위 테스트를 작성할 때까지 실제 코드를 작성하지 않는다.
2. 컴파일은 실패하지 않으면서 실행이 실패하는 정도로만 단위 테스트를 작성한다.
3. 현재 실패하는 테스트를 통과할 정도로만 실제 코드를 작성한다.

위의 법칙을 따른다면 수 백, 수 천개의 테스트코드가 작성되어 관리가 매우 어려워지기도 한다.

### 깨끗한 테스트 코드 유지하기
**깨끗한 테스트 코드 vs 단순히 돌아가는 테스트 코드 ?**
지저분한 테스트코드는 실제 코드를 짜는 시간보다 더 오래걸리게 되고, 실제 코드를 변경했을 때 복잡한 테스트 코드 때문에 더욱 복잡하고, 통과시키기 어려워진다.
> 테스트 코드는 실제 코드 못지 않게 중요하다. 테스트 코드는 사고와 설계와 주의가 필요하다. 실제 코드 못지 않게 깨끗하게 짜야한다. 

***테스트는 유연성, 유지보수성, 재사용성을 제공한다.***
코드에 유연성, 유지보수성, 재사용성을 제공하는 버팀목이 바로 **단위 테스트**이다. 테스트 케이스가 있다면 변경이 두렵지 않다. 

### 깨끗한 테스트 코드
> 깨끗한 테스트 코드를 만들기 위해 세 가지가 필요하다. 가독성, 가독성, 가독성!

```BUILD-OPERATE-CHECK``` 패턴
1. 테스트 자료를 만든다.
2. 테스트 자료를 조작한다.
3. 조작한 결과가 올바른지 확인한다.

***도메인에 특화된 테스트 언어***

***이중 표현***
테스트 API 코드는 실제 코드의 표준과는 다르다. 단순하고, 간결하고, 표현력이 풍부해야 하지만, 실제 코드처럼 효율적일 필요는 없다.
임베디드 환경에서 돌아가는 코드의 테스트코드에서 ```StringBuffer```를 사용하면 자원문제가 생길 수 있다. 하지만, 테스트 코드에서는 전혀 문제가 되지 않는다. 

###테스트 당 assert 하나
하나의 메서드에 하나의 assert만 들어가야 한다는 주장. 
given-when-then 관례
테스트를 이렇게 분리하면 중복되는 코드가 많아진다. TEMPLATE MOTHOD 패턴을 이용하면 부모클래스에 given과 when이 들어가고 자식 클래스에 then이 들어간다. 
최대한 ```assert```문이 줄여야 한다.

***테스트 당 개념 하나***
> 테스트 함수마다 한 개념만 테스트 하라.

### F.I.R.S.T
깨끗한 테스트는 다음 다섯 가지 규칙을 따른다.
1. F(FAST) : 테스트는 빨라야한다. 느리면 자주 돌릴 엄두를 내지 못 한다.
2. I(Independent) : 각 테스트는 서로 의존하면 안 된다. 테스트 간에 의존성이  있다면 하나 실패 시 다른 테스트 또한 함께 실패하여 실패 원인을 진단하기 어려워진다.
3. R(Repeatable) : 어떤 환경에서도 반복이 가능하게. 
4. S(Self-Validating) : 테스트는 ```Boolean``` 값으로 결과를 내야 한다. 로그를 보도록 하지 말자.
5. T(Timely) : 적시에 작성하라. 실제 코드를 작성하고 테스트 코드를 짠다면 실제 코드가 테스트하기 어렵다는 사실을 알게될 지도 모른다. 

### 결론
테스트 코드가 방치되어 망가지면 실제 코드도 망가진다. 테스트 코드를 깨끗하게 유지하자.


















